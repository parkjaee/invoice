================================================================================
                    INVOICE 프로젝트 아키텍처 구성 체크리스트
================================================================================
작성일: 2025-10-30
프로젝트: Invoice (Station files & airline Invoice)
기술 스택: Spring Boot 3.4.10 + React 18 + Oracle

================================================================================
1. 백엔드 (Spring Boot) 기본 설정
================================================================================

[ ] 1.1 의존성 추가 (pom.xml)
    위치: invoice/pom.xml

    추가 필요한 의존성:
    - MyBatis Spring Boot Starter (3.0.3)
      → 프로시저 호출용

    - Spring Boot Starter Validation
      → DTO 검증용

    - Spring Boot DevTools (선택)
      → 개발 편의성

    수정 방법:
    pom.xml의 <dependencies> 섹션에 추가

---

[ ] 1.2 데이터베이스 연결 설정 (application.properties 또는 application.yml)
    위치: invoice/src/main/resources/application.properties

    현재 상태:
    spring.application.name=invoice (1줄만 존재)

    추가 필요한 설정:

    # Oracle 데이터베이스 연결
    spring.datasource.url=jdbc:oracle:thin:@<호스트>:<포트>:<SID>
    spring.datasource.username=<사용자명>
    spring.datasource.password=<비밀번호>
    spring.datasource.driver-class-name=oracle.jdbc.OracleDriver

    # JPA 설정
    spring.jpa.hibernate.ddl-auto=none
    spring.jpa.show-sql=true
    spring.jpa.properties.hibernate.format_sql=true
    spring.jpa.database-platform=org.hibernate.dialect.OracleDialect

    # MyBatis 설정 (추가 시)
    mybatis.mapper-locations=classpath:mapper/**/*.xml
    mybatis.type-aliases-package=com.aact.invoice.dto
    mybatis.configuration.map-underscore-to-camel-case=true

    # 서버 포트 (선택)
    server.port=8080

    # CORS 설정 (개발용)
    # 프론트엔드(React)와 통신 허용

    주의: 실제 DB 접속 정보는 별도 관리 필요 (환경변수 또는 .env 파일)

---

[ ] 1.3 프로젝트 패키지 구조 생성
    위치: invoice/src/main/java/com/aact/invoice/

    생성 필요한 패키지:

    com.aact.invoice/
    ├── controller/          # REST API 엔드포인트
    ├── service/             # 비즈니스 로직
    ├── repository/          # JPA Repository
    │   └── mybatis/         # MyBatis Mapper (프로시저용)
    ├── entity/              # JPA 엔티티 (테이블 매핑)
    ├── dto/                 # 데이터 전송 객체
    │   ├── request/         # 요청 DTO
    │   └── response/        # 응답 DTO
    ├── config/              # 설정 클래스
    │   ├── WebConfig.java   # CORS 설정
    │   └── MyBatisConfig.java (선택)
    └── exception/           # 예외 처리

---

[ ] 1.4 MyBatis Mapper XML 디렉토리 생성
    위치: invoice/src/main/resources/mapper/

    생성 필요한 구조:
    resources/
    └── mapper/
        ├── InvoiceMapper.xml      # Invoice 관련 프로시저
        └── CommonMapper.xml       # 공통 프로시저

---

[ ] 1.5 CORS 설정 클래스 작성
    위치: invoice/src/main/java/com/aact/invoice/config/WebConfig.java

    목적: React 프론트엔드(localhost:5173)와 통신 허용

    작성 필요 내용:
    @Configuration
    public class WebConfig implements WebMvcConfigurer {
        @Override
        public void addCorsMappings(CorsRegistry registry) {
            registry.addMapping("/api/**")
                    .allowedOrigins("http://localhost:5173")
                    .allowedMethods("GET", "POST", "PUT", "DELETE")
                    .allowCredentials(true);
        }
    }

================================================================================
2. MyBatis 구성 (프로시저 사용 시)
================================================================================

[ ] 2.1 MyBatis Mapper 인터페이스 작성 예시
    위치: invoice/src/main/java/com/aact/invoice/repository/mybatis/

    예시:
    @Mapper
    public interface InvoiceMapper {
        // 프로시저 호출 예시
        List<InvoiceDTO> getInvoiceList(InvoiceSearchParams params);
        void saveInvoice(InvoiceSaveRequest request);
    }

---

[ ] 2.2 MyBatis Mapper XML 작성 예시
    위치: invoice/src/main/resources/mapper/InvoiceMapper.xml

    예시 구조:
    <?xml version="1.0" encoding="UTF-8"?>
    <!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
    <mapper namespace="com.aact.invoice.repository.mybatis.InvoiceMapper">

        <select id="getInvoiceList" statementType="CALLABLE" resultType="InvoiceDTO">
            {CALL PACKAGE_NAME.PROCEDURE_NAME(
                #{param1, mode=IN},
                #{result, mode=OUT, jdbcType=CURSOR, resultMap=invoiceResultMap},
                #{errorFlag, mode=OUT}
            )}
        </select>

    </mapper>

================================================================================
3. JPA 엔티티 구성 (단순 테이블용)
================================================================================

[ ] 3.1 예제 엔티티 작성
    위치: invoice/src/main/java/com/aact/invoice/entity/

    작성 필요 내용:
    - Invoice.java (기본 엔티티)
    - Code.java (코드 마스터)
    - 등등...

    예시:
    @Entity
    @Table(name = "TBL_INVOICE")
    @Data
    @NoArgsConstructor
    @AllArgsConstructor
    public class Invoice {
        @Id
        @GeneratedValue(strategy = GenerationType.SEQUENCE, generator = "invoice_seq")
        @SequenceGenerator(name = "invoice_seq", sequenceName = "SEQ_INVOICE", allocationSize = 1)
        @Column(name = "INVOICE_ID")
        private Long invoiceId;

        @Column(name = "INVOICE_NO")
        private String invoiceNo;

        // ... 추가 필드
    }

---

[ ] 3.2 JPA Repository 작성
    위치: invoice/src/main/java/com/aact/invoice/repository/

    예시:
    public interface InvoiceRepository extends JpaRepository<Invoice, Long> {
        List<Invoice> findByInvoiceNo(String invoiceNo);
        // 커스텀 쿼리 메서드
    }

================================================================================
4. REST API 구성
================================================================================

[ ] 4.1 Controller 작성
    위치: invoice/src/main/java/com/aact/invoice/controller/

    예시:
    @RestController
    @RequestMapping("/api/invoices")
    @RequiredArgsConstructor
    public class InvoiceController {

        private final InvoiceService invoiceService;

        @GetMapping
        public ResponseEntity<List<InvoiceDTO>> getInvoices(
            @RequestParam(required = false) String invoiceNo
        ) {
            List<InvoiceDTO> invoices = invoiceService.getInvoices(invoiceNo);
            return ResponseEntity.ok(invoices);
        }

        @PostMapping
        public ResponseEntity<InvoiceDTO> createInvoice(
            @RequestBody @Valid InvoiceCreateRequest request
        ) {
            InvoiceDTO invoice = invoiceService.createInvoice(request);
            return ResponseEntity.ok(invoice);
        }
    }

---

[ ] 4.2 Service 작성
    위치: invoice/src/main/java/com/aact/invoice/service/

    하이브리드 접근:
    - 단순 CRUD → JPA Repository 사용
    - 복잡한 로직 → MyBatis Mapper 사용 (프로시저)

    예시:
    @Service
    @RequiredArgsConstructor
    public class InvoiceService {

        private final InvoiceRepository invoiceRepository;  // JPA
        private final InvoiceMapper invoiceMapper;          // MyBatis

        // 단순 조회 (JPA)
        public List<InvoiceDTO> getInvoices(String invoiceNo) {
            return invoiceRepository.findByInvoiceNo(invoiceNo)
                .stream()
                .map(this::toDTO)
                .collect(Collectors.toList());
        }

        // 복잡한 로직 (MyBatis 프로시저)
        public void processComplexInvoice(InvoiceRequest request) {
            invoiceMapper.callComplexProcedure(request);
        }
    }

---

[ ] 4.3 DTO 작성
    위치: invoice/src/main/java/com/aact/invoice/dto/

    작성 필요:
    - InvoiceDTO.java (응답용)
    - InvoiceCreateRequest.java (생성 요청용)
    - InvoiceUpdateRequest.java (수정 요청용)
    - InvoiceSearchParams.java (검색 조건용)

    예시:
    @Data
    @Builder
    public class InvoiceDTO {
        private Long invoiceId;
        private String invoiceNo;
        private String customerName;
        private LocalDateTime createdDate;
        // ...
    }

================================================================================
5. 프론트엔드 (React) 구성
================================================================================

[ ] 5.1 API 서비스 레이어 작성
    위치: invoice_front/src/services/

    작성 필요:
    - api.js (Axios 기본 설정)
    - invoiceService.js (Invoice API 호출)

    예시 (api.js):
    import axios from 'axios';

    const api = axios.create({
        baseURL: 'http://localhost:8080/api',
        timeout: 10000,
        headers: {
            'Content-Type': 'application/json'
        }
    });

    export default api;

    예시 (invoiceService.js):
    import api from './api';

    export const invoiceService = {
        getInvoices: (params) => api.get('/invoices', { params }),
        createInvoice: (data) => api.post('/invoices', data),
        updateInvoice: (id, data) => api.put(`/invoices/${id}`, data),
        deleteInvoice: (id) => api.delete(`/invoices/${id}`)
    };

---

[ ] 5.2 컴포넌트 구조 생성
    위치: invoice_front/src/components/

    생성 필요한 구조:
    components/
    ├── Invoice/
    │   ├── InvoiceList.jsx       # 목록 화면
    │   ├── InvoiceForm.jsx       # 등록/수정 폼
    │   ├── InvoiceDetail.jsx     # 상세 화면
    │   └── InvoicePrint.jsx      # 인쇄 화면 (PDF 생성)
    ├── common/
    │   ├── Layout.jsx            # 공통 레이아웃
    │   ├── Header.jsx            # 헤더
    │   └── Sidebar.jsx           # 사이드바
    └── ui/
        ├── DataGrid.jsx          # 재사용 가능한 그리드
        └── DatePicker.jsx        # 재사용 가능한 날짜 선택

---

[ ] 5.3 상태 관리 (선택사항)

    옵션 1: React Query 사용 (추천)
    - 설치: npm install @tanstack/react-query
    - 서버 상태 관리 자동화
    - 캐싱, 재시도, 동기화 등 자동 처리

    옵션 2: Context API (간단한 경우)
    - React 내장 기능
    - 전역 상태 관리

    옵션 3: Redux (복잡한 경우)
    - 설치: npm install @reduxjs/toolkit react-redux
    - 대규모 상태 관리

---

[ ] 5.4 라우팅 설정
    위치: invoice_front/src/App.jsx

    필요 라이브러리:
    - React Router: npm install react-router-dom

    예시 구조:
    import { BrowserRouter, Routes, Route } from 'react-router-dom';

    function App() {
        return (
            <BrowserRouter>
                <Routes>
                    <Route path="/" element={<Layout />}>
                        <Route index element={<InvoiceList />} />
                        <Route path="invoices/new" element={<InvoiceForm />} />
                        <Route path="invoices/:id" element={<InvoiceDetail />} />
                        <Route path="invoices/:id/edit" element={<InvoiceForm />} />
                    </Route>
                </Routes>
            </BrowserRouter>
        );
    }

================================================================================
6. 데이터베이스 준비
================================================================================

[ ] 6.1 Oracle 스키마 생성

    필요한 작업:
    - 테이블 설계
    - 시퀀스 생성
    - 인덱스 생성
    - 제약조건 설정

---

[ ] 6.2 프로시저 작성 (필요 시)

    위치: Oracle DB

    작성 필요 프로시저:
    - 조회 프로시저
    - 등록 프로시저
    - 수정 프로시저
    - 삭제 프로시저
    - 복잡한 비즈니스 로직 프로시저

---

[ ] 6.3 초기 데이터 입력

    필요한 마스터 데이터:
    - 코드 테이블 (부서, 직급, 상태 등)
    - 기본 설정 데이터
    - 테스트 데이터

================================================================================
7. 개발 환경 설정
================================================================================

[ ] 7.1 Git 설정

    .gitignore 확인 필요:
    - application.properties (DB 정보)
    - node_modules/
    - target/
    - .env

    Git 초기화 (필요 시):
    cd invoice
    git init
    git add .
    git commit -m "Initial commit"

---

[ ] 7.2 환경변수 관리

    백엔드 (application-dev.properties, application-prod.properties):
    - 개발/운영 환경 분리
    - DB 접속 정보 환경별 관리

    프론트엔드 (.env.development, .env.production):
    VITE_API_BASE_URL=http://localhost:8080/api

---

[ ] 7.3 개발 도구 설정

    IntelliJ IDEA (백엔드):
    - Lombok 플러그인 설치
    - Spring Boot Run Configuration 설정

    VS Code (프론트엔드):
    - ESLint 설정 확인
    - Prettier 설정 (선택)
    - React 관련 확장 설치

================================================================================
8. 테스트 환경 구성
================================================================================

[ ] 8.1 백엔드 테스트

    위치: invoice/src/test/java/com/aact/invoice/

    작성 필요:
    - Controller 테스트 (MockMvc)
    - Service 테스트
    - Repository 테스트

    사용 도구:
    - JUnit 5
    - Mockito
    - Spring Boot Test

---

[ ] 8.2 프론트엔드 테스트 (선택)

    도구:
    - Jest (단위 테스트)
    - React Testing Library (컴포넌트 테스트)

================================================================================
9. 빌드 및 배포 준비
================================================================================

[ ] 9.1 백엔드 빌드

    명령어:
    cd invoice
    ./mvnw clean package

    결과물: target/invoice-0.0.1-SNAPSHOT.jar

---

[ ] 9.2 프론트엔드 빌드

    명령어:
    cd invoice_front
    npm run build

    결과물: dist/ 폴더

---

[ ] 9.3 배포 전략 수립

    옵션:
    - 단일 서버 배포 (Nginx + Spring Boot)
    - Docker 컨테이너화
    - Cloud 배포 (AWS, Azure 등)

================================================================================
10. 우선순위별 작업 순서 (추천)
================================================================================

Phase 1: 기본 인프라 (1-2일)
-----------------------------
1. [필수] 1.2 데이터베이스 연결 설정
2. [필수] 1.5 CORS 설정
3. [필수] 1.3 패키지 구조 생성
4. [필수] 6.1 Oracle 스키마 생성

Phase 2: 백엔드 기본 구조 (2-3일)
----------------------------------
5. [필수] 3.1 JPA 엔티티 작성 (1-2개)
6. [필수] 3.2 JPA Repository 작성
7. [필수] 4.1 Controller 작성 (기본 CRUD)
8. [필수] 4.2 Service 작성
9. [필수] 4.3 DTO 작성

Phase 3: 프론트엔드 연동 (2-3일)
---------------------------------
10. [필수] 5.1 API 서비스 레이어 작성
11. [필수] 5.2 기본 컴포넌트 작성
12. [필수] 5.4 라우팅 설정
13. [선택] 5.3 상태 관리 (React Query 추천)

Phase 4: MyBatis 추가 (필요 시, 1-2일)
---------------------------------------
14. [조건부] 1.1 MyBatis 의존성 추가
15. [조건부] 2.1 MyBatis Mapper 인터페이스
16. [조건부] 2.2 MyBatis Mapper XML
17. [조건부] 6.2 프로시저 작성

Phase 5: 고도화 (진행 중)
--------------------------
18. [선택] 7.1 Git 설정
19. [선택] 8.1 테스트 작성
20. [선택] 9.1-9.3 빌드 및 배포

================================================================================
11. 현재 프로젝트 상태
================================================================================

✅ 완료:
- Spring Boot 프로젝트 생성
- React 프로젝트 생성
- 기본 의존성 설정 (JPA, Web, Oracle JDBC, Lombok)
- React 개발 서버 실행 (http://localhost:5173)

❌ 미완료:
- 데이터베이스 연결 설정
- 백엔드 실행 확인
- API 엔드포인트 작성
- 프론트엔드-백엔드 연동
- MyBatis 설정 (선택)

================================================================================
12. 즉시 확인 필요한 사항
================================================================================

[ ] Oracle DB 접속 정보
    - 호스트: ?
    - 포트: ?
    - SID/서비스명: ?
    - 사용자명: ?
    - 비밀번호: ?

[ ] 프로시저 목록
    - 어떤 프로시저들이 있는지?
    - 각 프로시저의 파라미터는?
    - IN/OUT 파라미터 구조는?

[ ] 테이블 구조
    - 어떤 테이블들이 필요한지?
    - 각 테이블의 컬럼은?
    - 관계는 어떻게 되는지?

[ ] 비즈니스 요구사항
    - 어떤 기능이 필요한지?
    - 화면 구성은 어떻게 할지?
    - 사용자 권한은?

================================================================================
13. 참고 자료
================================================================================

Spring Boot 공식 문서:
https://spring.io/projects/spring-boot

MyBatis Spring Boot:
https://mybatis.org/spring-boot-starter/mybatis-spring-boot-autoconfigure/

React Router:
https://reactrouter.com/

Material-UI (MUI):
https://mui.com/

React Query:
https://tanstack.com/query/latest

================================================================================
작성 완료
================================================================================

다음 단계:
1. Oracle DB 접속 정보 확인
2. application.properties 설정
3. 백엔드 서버 실행 테스트
4. 간단한 REST API 작성 및 테스트
5. 프론트엔드에서 API 호출 테스트

질문이 있으면 언제든지 물어보세요!
